
For an Ubuntu virtual machine (VM), here's a step-by-step guide to disable directory listing in Apache:

1. Connect to Your Ubuntu VM
Make sure you're logged into your Ubuntu VM. You can either use SSH or access the terminal directly if you’re on the VM itself.

2. Find the Apache Configuration File
On Ubuntu, the main Apache configuration file is typically located at /etc/apache2/apache2.conf, and site-specific configurations are usually found in /etc/apache2/sites-available/000-default.conf.

For this guide, we'll edit the default site configuration (000-default.conf) to disable directory listing.

3. Edit the Configuration File
Open the Apache configuration file for the default site in a text editor. We’ll use nano in this example.

sudo nano /etc/apache2/sites-available/000-default.conf
4. Disable Directory Listing
Inside this file, find the <Directory> block. If it doesn’t exist, you can create one. We’ll add the Options -Indexes directive inside this block to disable directory listing.

Example configuration:

<VirtualHost *:80>
    # Other configurations
    DocumentRoot /var/www/html

    <Directory /var/www/html>
        Options -Indexes
        AllowOverride All   # Allow .htaccess files to override settings
    </Directory>
</VirtualHost>
Here, Options -Indexes disables directory listing, and AllowOverride All allows .htaccess files to override this setting if needed.

5. Enable .htaccess (if needed)
If you want to manage this setting via .htaccess files, you need to ensure that AllowOverride is set to All for the relevant directory. This allows directory-specific configuration through .htaccess files.

Ensure this line exists in the <Directory> block, as shown above:

AllowOverride All
6. Restart Apache
After saving your changes, restart Apache to apply the new settings.

sudo systemctl restart apache2
7. Verify the Changes
To check if the directory listing is successfully disabled, navigate to a directory in your website’s root that doesn’t have an index.html or index.php file.

For example, visit http://your-vm-ip-address/some-directory/ in a web browser. If directory listing is disabled, you should see a "403 Forbidden" error, instead of a list of files.